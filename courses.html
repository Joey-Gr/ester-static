<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>Personal - Start Bootstrap Theme</title>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
  <!-- Custom Google font-->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"
    rel="stylesheet" />
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="css/styles.css" rel="stylesheet" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

</head>

<body class="d-flex flex-column h-100 body-background">
  <a class="d-none d-lg-block" href="index.html">
    <div style="height: 100px; background-image: url('assets/banner.png'); background-size: contain;"></div>
    <hr class="dashed-divider" />
  </a>
  <main class="flex-shrink-0 container mt-5 bg-light">
    <!-- Navigation-->
    <div id="navbar-container"></div>
    <!-- Header-->
    <header class="">
      <div class="container px-5 pt-3">
        <div class="row gx-5 m-auto border rounded-3 bg-white py-4 mb-3" style="max-width:1024px;">
          <!-- Cours -->
          <div class="col-lg-8">
            <div>
              <h2>Cours</h2>
              <p>Ester propose des cours ou des ateliers autour du vin et de la d√©gustation destin√©s √† tous les niveaux
                : un ¬´ cours essai ¬ª pour s‚Äôinitier, des ¬´ ateliers d√©couverte ¬ª pour apprendre et s‚Äôamuser, des cours
                de culture g√©n√©rale avec une progression en 3 √©tapes pour les plus passionn√©s, des cours ponctuels ou √†
                l‚Äôann√©e si vous le souhaitez, nous vous offrons le choix du format et du sujet. Tous les vins que nous
                avons choisi de vous faire d√©guster sont naturels.</p>
            </div>
          </div>
          <div class="col-lg-4">
            <!-- Content Picture -->
            <div class="d-flex justify-content-center mt-lg-0">
              <img class="text-center rounded object-fit-contain w-100" src="assets/picto/COURS.svg" />
            </div>
          </div>
        </div>
        <div class="d-block w-50 m-auto d-lg-flex justify-content-center my-3">
          <a href="courses-general.html" class="m-2 rounded-circle border border-primary border-4 btn btn-primary"
            data-bs-toggle="tooltip" data-bs-title="Cours g√©n√©raux">
            <div class="d-flex align-items-center justify-content-center text-center"
              style="height: 128px; width: 128px;">
              <i class="est es-cours-gen es-75"></i>
            </div>
          </a>
          <a href="courses-workshop.html" class="m-2 rounded-circle border border-primary border-4 btn btn-primary"
            data-bs-toggle="tooltip" data-bs-title="Atelier d√©couverte">
            <div class="d-flex align-items-center justify-content-center text-center"
              style="height: 128px; width: 128px;">
              <i class="est es-ateliers-dec es-75"></i>
            </div>
          </a>
          <a href="courses-tests.html" class="m-2 rounded-circle border border-primary border-4 btn btn-primary"
            data-bs-toggle="tooltip" data-bs-title="Essais">
            <div class="d-flex align-items-center justify-content-center text-center"
              style="height: 128px; width: 128px;">
              <i class="est es-essai es-75"></i>
            </div>
          </a>
        </div>
        <hr>
        <div class="row gx-5">
          <!-- Localisation -->
          <div class="col-lg-4">
            <h3>
              Localisation<a id="map-reset" class="btn btn-sm" data-bs-toggle="tooltip"
                data-bs-title="R√©initaliser">üîÑ</a>
            </h3>
            <ul id="location-list" class="list-group"></ul>
          </div>
          <div class="col-lg-8">
            <div class="border border-2 border-dark rounded" id="map" style="height:500px"></div>
          </div>
        </div>
        <hr>

        <!-- A domicile -->
        <div class="row gx-5">
          <div class="col-lg-10">
            <h3>A domicile</h3>
            <p>
              Nous nous d√©pla√ßons chez vous pour organiser un cours, un atelier ou un √©v√®nement (comme une d√©gustation
              vente) selon vos envies. Vous pouvez nous contacter pour plus de renseignements.
            </p>
          </div>
          <div class="col-lg-2">
            <div class="d-flex justify-content-center mt-xxl-0">
              <img class="text-center rounded object-fit-contain w-100" src="assets/picto/VENTES_A_DOMICILE.svg" />
            </div>
          </div>
        </div>
        <hr>

        <!-- Comite entreprise -->
        <div class="row gx-5">
          <div class="col-lg-10">
            <h3>Comit√© d'entreprise</h3>
            <p>
              Ester organise des √©v√®nements pour les comit√©s d‚Äôentreprise : cours ou ateliers de d√©gustation sur un
              sujet au choix, ventes avec possibilit√© de pr√©sence de nos producteurs ou productrices, animation
              d‚Äôateliers ludiques pour f√©d√©rer vos √©quipes.
              <br>
              Pour demander un devis, <a href="contact.html">contactez-nous</a>.
            </p>
          </div>
          <div class="col-lg-2">
            <div class="d-flex justify-content-center mt-xxl-0">
              <img class="text-center rounded object-fit-contain w-100" src="assets/picto/ENTREPRISE.svg" />
            </div>
          </div>
        </div>
        <br>
    </header>
    <!-- Footer-->
    <div id="footer-container">
  </main>
  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Core theme JS-->
  <script src="js/scripts.js"></script>

  <script>
    // LEAFLET
    const defaultCnt = [46, 2]
    const defaultZm = 5

    const map = L.map('map').setView(defaultCnt, defaultZm);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    let shapes = [];
    let lastLocationEl = null

    // Reset Map View
    document.getElementById('map-reset').addEventListener('click', () => {
      map.setView(defaultCnt, defaultZm);
      if (lastLocationEl) lastLocationEl.classList.remove('disabled'), lastLocationEl = null

      // Close all popups
      map.eachLayer(layer => {
        if (layer.closePopup) layer.closePopup();
      });
    });

    fetch('assets/data/localisations.json')
      .then(res => res.json())
      .then(data => {
        const listContainer = document.getElementById('location-list');

        data.forEach((location, index) => {
          // Check if single point
          if (location) {
            let layer = null
            if (typeof location.coordinates[0] === "number") {
              // Single point: [lng, lat]
              const latlng = [location.coordinates[1], location.coordinates[0]];
              layer = L.marker(latlng, {
                polygon: false,
              })
                .addTo(map)
                .bindPopup(`<strong>${location.name}</strong><br>${location.description}`);
            } else {
              // Convert [lng, lat] to [lat, lng] for Leaflet
              const latLngs = location.coordinates.map(coord => [coord[1], coord[0]]);

              // Create polygon
              layer = L.polygon(latLngs, {
                color: 'cornflowerblue',
                polygon: true,
                weight: 2
              }).addTo(map)
                .bindPopup(`<strong>${location.name}</strong><br>${location.description}`)

              shapes.push(layer)
            }

            // Create list item
            const li = document.createElement('li')
            li.className = 'list-group-item location-item btn'
            li.textContent = location.name;
            li.addEventListener('click', (ev) => {
              if (lastLocationEl) lastLocationEl.classList.remove('disabled')
              lastLocationEl = ev.target
              ev.target.classList.add('disabled')
              console.log(layer)
              if (layer.options && layer.options.polygon) map.fitBounds(layer.getBounds())
              else map.setView(layer.getLatLng(), 9)
              layer.openPopup()
            });

            listContainer.appendChild(li)
          }
        });
      });

  </script>

  <!-- COMPONENTS -->
  <script src="js/components/navbar.js"></script>
  <script src="js/components/footer.js"></script>
</body>

</html>